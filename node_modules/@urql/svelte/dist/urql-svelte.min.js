var e=require("@urql/core"),t=require("svelte/store"),n=require("svelte"),r=require("wonka");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(n,r,a){var o={query:n,variables:r||null,context:a},u={stale:!1,fetching:!1,data:void 0,error:void 0,extensions:void 0},c=t.writable(u),s=!1;return u.set=function(t){if(t&&t!==u){s=!0;var n=!1;if("query"in t||"variables"in t){var r=e.createRequest(o.query,o.variables),i=e.createRequest(t.query||o.query,t.variables||o.variables);r.key!==i.key&&(n=!0,o.query=t.query||o.query,o.variables=t.variables||o.variables||null)}for(var a in"context"in t&&e.stringifyVariables(o.context)!==e.stringifyVariables(t.context)&&(n=!0,o.context=t.context),t)"query"!==a&&"variables"!==a&&"context"!==a&&("fetching"===a?u[a]=!!t[a]:a in u&&(u[a]=t[a]),n=!0);u.stale=!!t.stale,s=!1,n&&c.set(u)}},u.update=function(e){u.set(e(u))},u.subscribe=function(e,t){return c.subscribe(e,t)},u.reexecute=function(e){o.context=i({},e||o.context),c.set(u)},Object.keys(o).forEach((function(e){Object.defineProperty(u,e,{configurable:!1,get:function(){return o[e]},set:function(t){o[e]=t,s||c.set(u)}})})),u}function o(){return n.getContext("$$_urql")}function u(e){n.setContext("$$_urql",e)}new WeakSet;var c={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0};function s(t){return r.make((function(n){var r,i={};return t.subscribe((function(t){var a=e.createRequest(t.query,t.variables);(a.context=t.context)===i&&a.key===r||(r=a.key,i=t.context,n.next(a))}))}))}exports.getClient=o,exports.initClient=function(t){var n=new e.Client(t);return u(n),n},exports.mutation=function(t){var n=o(),u="function"!=typeof t.subscribe?a(t.query,t.variables):t;return function(t,a){return u.set({fetching:!0,variables:t||u.variables,context:a||u.context}),r.toPromise(r.take(1)(n.executeMutation(e.createRequest(u.query,u.variables||{}),u.context))).then((function(e){var t=i({},{fetching:!1},e);return u.set(t),u}))}},exports.operationStore=a,exports.query=function(e){var t=o(),a=r.subscribe((function(t){e.set(t)}))(r.scan((function(e,t){return i({},e,t)}),c)(r.switchMap((function(e){return e.context&&e.context.pause?r.fromValue({fetching:!1,stale:!1}):r.concat([r.fromValue({fetching:!0,stale:!1}),r.map((function(e){return i({},{fetching:!1},e,{stale:!!e.stale})}))(t.executeQuery(e,e.context)),r.fromValue({fetching:!1,stale:!1})])}))(s(e))));return n.onDestroy(a.unsubscribe),e},exports.setClient=u,exports.subscription=function(e,t){var a=o(),u=r.subscribe((function(t){e.set(t)}))(r.scan((function(e,n){return i({},e,n,{data:void 0!==n.data?"function"==typeof t?t(e.data,n.data):n.data:e.data,stale:!1})}),c)(r.switchMap((function(t){return t.context&&t.context.pause?r.fromValue({fetching:!1}):r.concat([r.fromValue({fetching:!0}),a.executeSubscription(t,e.context),r.fromValue({fetching:!1})])}))(s(e))));return n.onDestroy(u.unsubscribe),e},Object.keys(e).forEach((function(t){"default"===t||exports.hasOwnProperty(t)||(exports[t]=e[t])}));
//# sourceMappingURL=urql-svelte.min.js.map
