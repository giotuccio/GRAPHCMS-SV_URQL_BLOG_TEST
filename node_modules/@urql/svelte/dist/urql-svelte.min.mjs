import{createRequest as t,stringifyVariables as e,Client as n}from"@urql/core";export*from"@urql/core";import{writable as r}from"svelte/store";import{getContext as i,setContext as o,onDestroy as u}from"svelte";import{subscribe as c,scan as a,switchMap as s,fromValue as f,concat as l,map as v,make as b,toPromise as x,take as y}from"wonka";function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function d(n,i,o){var u={query:n,variables:i||null,context:o},c={stale:!1,fetching:!1,data:void 0,error:void 0,extensions:void 0},a=r(c),s=!1;return c.set=function(n){if(n&&n!==c){s=!0;var r=!1;if("query"in n||"variables"in n){var i=t(u.query,u.variables),o=t(n.query||u.query,n.variables||u.variables);i.key!==o.key&&(r=!0,u.query=n.query||u.query,u.variables=n.variables||u.variables||null)}for(var f in"context"in n&&e(u.context)!==e(n.context)&&(r=!0,u.context=n.context),n)"query"!==f&&"variables"!==f&&"context"!==f&&("fetching"===f?c[f]=!!n[f]:f in c&&(c[f]=n[f]),r=!0);c.stale=!!n.stale,s=!1,r&&a.set(c)}},c.update=function(t){c.set(t(c))},c.subscribe=function(t,e){return a.subscribe(t,e)},c.reexecute=function(t){u.context=p({},t||u.context),a.set(c)},Object.keys(u).forEach((function(t){Object.defineProperty(c,t,{configurable:!1,get:function(){return u[t]},set:function(e){u[t]=e,s||a.set(c)}})})),c}function h(){return i("$$_urql")}function g(t){o("$$_urql",t)}function q(t){var e=new n(t);return g(e),e}new WeakSet;var m={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0};function k(e){return b((function(n){var r,i={};return e.subscribe((function(e){var o=t(e.query,e.variables);(o.context=e.context)===i&&o.key===r||(r=o.key,i=e.context,n.next(o))}))}))}function O(t){var e=h(),n=c((function(e){t.set(e)}))(a((function(t,e){return p({},t,e)}),m)(s((function(t){return t.context&&t.context.pause?f({fetching:!1,stale:!1}):l([f({fetching:!0,stale:!1}),v((function(t){return p({},{fetching:!1},t,{stale:!!t.stale})}))(e.executeQuery(t,t.context)),f({fetching:!1,stale:!1})])}))(k(t))));return u(n.unsubscribe),t}function j(t,e){var n=h(),r=c((function(e){t.set(e)}))(a((function(t,n){return p({},t,n,{data:void 0!==n.data?"function"==typeof e?e(t.data,n.data):n.data:t.data,stale:!1})}),m)(s((function(e){return e.context&&e.context.pause?f({fetching:!1}):l([f({fetching:!0}),n.executeSubscription(e,t.context),f({fetching:!1})])}))(k(t))));return u(r.unsubscribe),t}function w(e){var n=h(),r="function"!=typeof e.subscribe?d(e.query,e.variables):e;return function(e,i){return r.set({fetching:!0,variables:e||r.variables,context:i||r.context}),x(y(1)(n.executeMutation(t(r.query,r.variables||{}),r.context))).then((function(t){var e=p({},{fetching:!1},t);return r.set(e),r}))}}export{h as getClient,q as initClient,w as mutation,d as operationStore,O as query,g as setClient,j as subscription};
//# sourceMappingURL=urql-svelte.min.mjs.map
